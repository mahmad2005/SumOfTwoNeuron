clc;
clear all;
theta = -4:0.01:4;
y = exp((1i*1.*theta)+log(2))*exp(1i*pi/2)+exp((1i*2.*theta)+log(2))*exp(1i*pi/2);

y_real = real(y);
y_imag = imag(y);

% f1= figure;
% plot(theta,y_real);
% hold on
% plot(theta,y_imag);
% xlabel('theta'),
% ylabel('y'),
% title('Complex Exponential Function - MATLAB Simulink');


% COS_FPGA_BR8
% SIN_FPGA_BR8
% COS_FPGA_IP8
% SIN_FPGA_IP8
% COS_FPGA_D8
% SIN_FPGA_D8



Theta = theta';
COS_MATLAB = cos(theta)';
SIN_MATLAB = sin(theta)';

MATLAB_IN_OUT = [Theta, COS_MATLAB, SIN_MATLAB];


fileID1 = fopen('IP32_FinalData_cos.txt','r');
fileID2 = fopen('IP32_FinalData_sin.txt','r');
formatSpec = '%f';

COS_FPGA_IP8 = fscanf(fileID1,formatSpec);
SIN_FPGA_IP8 = fscanf(fileID2,formatSpec);
COS_FPGA_IP8 = COS_FPGA_IP8(15:815);
SIN_FPGA_IP8 = SIN_FPGA_IP8(15:815);
z = COS_FPGA_IP8 + SIN_FPGA_IP8*1i;

% f2= figure;
% plot(theta,COS_FPGA_IP8);
% hold on
% plot(theta,SIN_FPGA_IP8);
% xlabel('theta'),
% ylabel('y'),
% title('FPGA output: 8-bit CORDIC Simulink');


fileID1 = fopen('BR32_FinalData_cos.txt','r');
fileID2 = fopen('BR32_FinalData_sin.txt','r');
formatSpec = '%f';

COS_FPGA_BR8 = fscanf(fileID1,formatSpec);
SIN_FPGA_BR8 = fscanf(fileID2,formatSpec);
COS_FPGA_BR8 = COS_FPGA_BR8(55:855);
SIN_FPGA_BR8 = SIN_FPGA_BR8(55:855);


fileID1 = fopen('D32_FinalData_cos.txt','r');
fileID2 = fopen('D32_FinalData_sin.txt','r');
formatSpec = '%f';

COS_FPGA_D8 = fscanf(fileID1,formatSpec);
SIN_FPGA_D8 = fscanf(fileID2,formatSpec);
COS_FPGA_D8 = COS_FPGA_D8(38:838);
SIN_FPGA_D8 = SIN_FPGA_D8(38:838);


f3= figure; f3.Position=[120   50   1200   600];
sgtitle('The output of the sum of two neurons using different approaches');
subplot(2,2,1), plot(theta,y_real), hold on, plot(theta,y_imag), xlabel('Theta'),ylabel('Amplitude'),title('MATLAB simulation');
subplot(2,2,2), plot(theta,COS_FPGA_BR8), hold on, plot(theta,SIN_FPGA_BR8) ,xlabel('Theta'),ylabel('Amplitude'),title('FPGA output: 32-bit Block-RAM Simulink');
subplot(2,2,3), plot(theta,COS_FPGA_IP8), hold on, plot(theta,SIN_FPGA_IP8) ,xlabel('Theta'),ylabel('Amplitude'),title('FPGA output: 32-bit CORDIC IP Simulink');
subplot(2,2,4), plot(theta,COS_FPGA_D8), hold on, plot(theta,SIN_FPGA_D8) ,xlabel('Theta'),ylabel('Amplitude'),title('FPGA output: 32-bit Direct VHDL in Vivado');

% FPGA_IN_OUT = [Theta, COS_FPGA_IP8, SIN_FPGA_IP8];
% 
% 
cos_abs_diff_BR8 = abs(y_real'-COS_FPGA_BR8);
sin_abs_diff_BR8 = abs(y_imag' - SIN_FPGA_BR8);
% 
cos_abs_diff_IP8 = abs(y_real'-COS_FPGA_IP8);
sin_abs_diff_IP8 = abs(y_imag' - SIN_FPGA_IP8);

cos_abs_diff_D8 = abs(y_real'-COS_FPGA_D8);
sin_abs_diff_D8 = abs(y_imag' - SIN_FPGA_D8);

f4= figure; f4.Position=[120   50   1200   300];
sgtitle('Absolute different of Real values');
subplot(1,3,1), plot(theta, cos_abs_diff_BR8), xlabel('Theta'),ylabel('Amplitude'),title('FPGA output: 32-bit Block-RAM');
subplot(1,3,2), plot(theta, cos_abs_diff_IP8) ,xlabel('Theta'),ylabel('Amplitude'),title('FPGA output: 32-bit CORDIC IP Simulink');
subplot(1,3,3), plot(theta, cos_abs_diff_D8) ,xlabel('Theta'),ylabel('Amplitude'),title('FPGA output: 32-bit direct VHDL in Vivado');

% 
 Avg_BR8_cos_abs_diff = sum( cos_abs_diff_BR8 )/801;
 Avg_BR8_sin_abs_diff = sum( sin_abs_diff_BR8 )/801;
 
 Avg_IP8_cos_abs_diff = sum( cos_abs_diff_IP8 )/801;
 Avg_IP8_sin_abs_diff = sum( sin_abs_diff_IP8 )/801;
 
 Avg_D8_cos_abs_diff = sum( cos_abs_diff_D8 )/801;
 Avg_D8_sin_abs_diff = sum( sin_abs_diff_D8 )/801;

 
 [1.00000001000000,2.00000001000000,3.00000001000000,4.00000001000000,5.00000001000000,6.00000001000000,7.00000001000000,8.00000001000000,9.00000001000000,10.0000000100000,11.0000000100000,12.0000000100000,13.0000000100000,14.0000000100000,15.0000000100000,16.0000000100000,17.0000000100000,18.0000000100000,19.0000000100000,20.0000000100000,21.0000000100000,22.0000000100000,23.0000000100000,24.0000000100000,25.0000000100000,26.0000000100000,27.0000000100000,28.0000000100000,29.0000000100000,30.0000000100000,31.0000000100000,32.0000000100000,33.0000000100000,34.0000000100000,35.0000000100000,36.0000000100000,37.0000000100000,38.0000000100000,39.0000000100000,40.0000000100000,41.0000000100000,42.0000000100000,43.0000000100000,44.0000000100000,45.0000000100000,46.0000000100000,47.0000000100000,48.0000000100000,49.0000000100000,50.0000000100000,51.0000000100000,52.0000000100000,53.0000000100000,54.0000000100000,55.0000000100000,56.0000000100000,57.0000000100000,58.0000000100000,59.0000000100000,60.0000000100000,61.0000000100000,62.0000000100000,63.0000000100000,64.0000000100000,65.0000000100000,66.0000000100000,67.0000000100000,68.0000000100000,69.0000000100000,70.0000000100000,71.0000000100000,72.0000000100000,73.0000000100000,74.0000000100000,75.0000000100000,76.0000000100000,77.0000000100000,78.0000000100000,79.0000000100000,80.0000000100000,81.0000000100000,82.0000000100000,83.0000000100000,84.0000000100000,85.0000000100000,86.0000000100000,87.0000000100000,88.0000000100000,89.0000000100000,90.0000000100000,91.0000000100000,92.0000000100000,93.0000000100000,94.0000000100000,95.0000000100000,96.0000000100000,97.0000000100000,98.0000000100000,99.0000000100000,100.000000010000,101.000000010000,102.000000010000,103.000000010000,104.000000010000,105.000000010000,106.000000010000,107.000000010000,108.000000010000,109.000000010000,110.000000010000,111.000000010000,112.000000010000,113.000000010000,114.000000010000,115.000000010000,116.000000010000,117.000000010000,118.000000010000,119.000000010000,120.000000010000,121.000000010000,122.000000010000,123.000000010000,124.000000010000,125.000000010000,126.000000010000,127.000000010000,128.000000010000,129.000000010000,130.000000010000,131.000000010000,132.000000010000,133.000000010000,134.000000010000,135.000000010000,136.000000010000,137.000000010000,138.000000010000,139.000000010000,140.000000010000,141.000000010000,142.000000010000,143.000000010000,144.000000010000,145.000000010000,146.000000010000,147.000000010000,148.000000010000,149.000000010000,150.000000010000,151.000000010000,152.000000010000,153.000000010000,154.000000010000,155.000000010000,156.000000010000,157.000000010000,158.000000010000,159.000000010000,160.000000010000,161.000000010000,162.000000010000,163.000000010000,164.000000010000,165.000000010000,166.000000010000,167.000000010000,168.000000010000,169.000000010000,170.000000010000,171.000000010000,172.000000010000,173.000000010000,174.000000010000,175.000000010000,176.000000010000,177.000000010000,178.000000010000,179.000000010000,180.000000010000,181.000000010000,182.000000010000,183.000000010000,184.000000010000,185.000000010000,186.000000010000,187.000000010000,188.000000010000,189.000000010000,190.000000010000,191.000000010000,192.000000010000,193.000000010000,194.000000010000,195.000000010000,196.000000010000,197.000000010000,198.000000010000,199.000000010000,200.000000010000,201.000000010000,202.000000010000,203.000000010000,204.000000010000,205.000000010000,206.000000010000,207.000000010000,208.000000010000,209.000000010000,210.000000010000,211.000000010000,212.000000010000,213.000000010000,214.000000010000,215.000000010000,216.000000010000,217.000000010000,218.000000010000,219.000000010000,220.000000010000,221.000000010000,222.000000010000,223.000000010000,224.000000010000,225.000000010000,226.000000010000,227.000000010000,228.000000010000,229.000000010000,230.000000010000,231.000000010000,232.000000010000,233.000000010000,234.000000010000,235.000000010000,236.000000010000,237.000000010000,238.000000010000,239.000000010000,240.000000010000,241.000000010000,242.000000010000,243.000000010000,244.000000010000,245.000000010000,246.000000010000,247.000000010000,248.000000010000,249.000000010000,250.000000010000,251.000000010000,252.000000010000,253.000000010000,254.000000010000,255.000000010000,256.000000010000,257.000000010000,258.000000010000,259.000000010000,260.000000010000,261.000000010000,262.000000010000,263.000000010000,264.000000010000,265.000000010000,266.000000010000,267.000000010000,268.000000010000,269.000000010000,270.000000010000,271.000000010000,272.000000010000,273.000000010000,274.000000010000,275.000000010000,276.000000010000,277.000000010000,278.000000010000,279.000000010000,280.000000010000,281.000000010000,282.000000010000,283.000000010000,284.000000010000,285.000000010000,286.000000010000,287.000000010000,288.000000010000,289.000000010000,290.000000010000,291.000000010000,292.000000010000,293.000000010000,294.000000010000,295.000000010000,296.000000010000,297.000000010000,298.000000010000,299.000000010000,300.000000010000,301.000000010000,302.000000010000,303.000000010000,304.000000010000,305.000000010000,306.000000010000,307.000000010000,308.000000010000,309.000000010000,310.000000010000,311.000000010000,312.000000010000,313.000000010000,314.000000010000,315.000000010000,316.000000010000,317.000000010000,318.000000010000,319.000000010000,320.000000010000,321.000000010000,322.000000010000,323.000000010000,324.000000010000,325.000000010000,326.000000010000,327.000000010000,328.000000010000,329.000000010000,330.000000010000,331.000000010000,332.000000010000,333.000000010000,334.000000010000,335.000000010000,336.000000010000,337.000000010000,338.000000010000,339.000000010000,340.000000010000,341.000000010000,342.000000010000,343.000000010000,344.000000010000,345.000000010000,346.000000010000,347.000000010000,348.000000010000,349.000000010000,350.000000010000,351.000000010000,352.000000010000,353.000000010000,354.000000010000,355.000000010000,356.000000010000,357.000000010000,358.000000010000,359.000000010000,360.000000010000,361.000000010000,362.000000010000,363.000000010000,364.000000010000,365.000000010000,366.000000010000,367.000000010000,368.000000010000,369.000000010000,370.000000010000,371.000000010000,372.000000010000,373.000000010000,374.000000010000,375.000000010000,376.000000010000,377.000000010000,378.000000010000,379.000000010000,380.000000010000,381.000000010000,382.000000010000,383.000000010000,384.000000010000,385.000000010000,386.000000010000,387.000000010000,388.000000010000,389.000000010000,390.000000010000,391.000000010000,392.000000010000,393.000000010000,394.000000010000,395.000000010000,396.000000010000,397.000000010000,398.000000010000,399.000000010000,400.000000010000,401.000000010000,402.000000010000,403.000000010000,404.000000010000,405.000000010000,406.000000010000,407.000000010000,408.000000010000,409.000000010000,410.000000010000,411.000000010000,412.000000010000,413.000000010000,414.000000010000,415.000000010000,416.000000010000,417.000000010000,418.000000010000,419.000000010000,420.000000010000,421.000000010000,422.000000010000,423.000000010000,424.000000010000,425.000000010000,426.000000010000,427.000000010000,428.000000010000,429.000000010000,430.000000010000,431.000000010000,432.000000010000,433.000000010000,434.000000010000,435.000000010000,436.000000010000,437.000000010000,438.000000010000,439.000000010000,440.000000010000,441.000000010000,442.000000010000,443.000000010000,444.000000010000,445.000000010000,446.000000010000,447.000000010000,448.000000010000,449.000000010000,450.000000010000,451.000000010000,452.000000010000,453.000000010000,454.000000010000,455.000000010000,456.000000010000,457.000000010000,458.000000010000,459.000000010000,460.000000010000,461.000000010000,462.000000010000,463.000000010000,464.000000010000,465.000000010000,466.000000010000,467.000000010000,468.000000010000,469.000000010000,470.000000010000,471.000000010000,472.000000010000,473.000000010000,474.000000010000,475.000000010000,476.000000010000,477.000000010000,478.000000010000,479.000000010000,480.000000010000,481.000000010000,482.000000010000,483.000000010000,484.000000010000,485.000000010000,486.000000010000,487.000000010000,488.000000010000,489.000000010000,490.000000010000,491.000000010000,492.000000010000,493.000000010000,494.000000010000,495.000000010000,496.000000010000,497.000000010000,498.000000010000,499.000000010000,500.000000010000,501.000000010000,502.000000010000,503.000000010000,504.000000010000,505.000000010000,506.000000010000,507.000000010000,508.000000010000,509.000000010000,510.000000010000,511.000000010000,512.000000010000,513.000000010000,514.000000010000,515.000000010000,516.000000010000,517.000000010000,518.000000010000,519.000000010000,520.000000010000,521.000000010000,522.000000010000,523.000000010000,524.000000010000,525.000000010000,526.000000010000,527.000000010000,528.000000010000,529.000000010000,530.000000010000,531.000000010000,532.000000010000,533.000000010000,534.000000010000,535.000000010000,536.000000010000,537.000000010000,538.000000010000,539.000000010000,540.000000010000,541.000000010000,542.000000010000,543.000000010000,544.000000010000,545.000000010000,546.000000010000,547.000000010000,548.000000010000,549.000000010000,550.000000010000,551.000000010000,552.000000010000,553.000000010000,554.000000010000,555.000000010000,556.000000010000,557.000000010000,558.000000010000,559.000000010000,560.000000010000,561.000000010000,562.000000010000,563.000000010000,564.000000010000,565.000000010000,566.000000010000,567.000000010000,568.000000010000,569.000000010000,570.000000010000,571.000000010000,572.000000010000,573.000000010000,574.000000010000,575.000000010000,576.000000010000,577.000000010000,578.000000010000,579.000000010000,580.000000010000,581.000000010000,582.000000010000,583.000000010000,584.000000010000,585.000000010000,586.000000010000,587.000000010000,588.000000010000,589.000000010000,590.000000010000,591.000000010000,592.000000010000,593.000000010000,594.000000010000,595.000000010000,596.000000010000,597.000000010000,598.000000010000,599.000000010000,600.000000010000,601.000000010000,602.000000010000,603.000000010000,604.000000010000,605.000000010000,606.000000010000,607.000000010000,608.000000010000,609.000000010000,610.000000010000,611.000000010000,612.000000010000,613.000000010000,614.000000010000,615.000000010000,616.000000010000,617.000000010000,618.000000010000,619.000000010000,620.000000010000,621.000000010000,622.000000010000,623.000000010000,624.000000010000,625.000000010000,626.000000010000,627.000000010000,628.000000010000,629.000000010000,630.000000010000,631.000000010000,632.000000010000,633.000000010000,634.000000010000,635.000000010000,636.000000010000,637.000000010000,638.000000010000,639.000000010000,640.000000010000,641.000000010000,642.000000010000,643.000000010000,644.000000010000,645.000000010000,646.000000010000,647.000000010000,648.000000010000,649.000000010000,650.000000010000,651.000000010000,652.000000010000,653.000000010000,654.000000010000,655.000000010000,656.000000010000,657.000000010000,658.000000010000,659.000000010000,660.000000010000,661.000000010000,662.000000010000,663.000000010000,664.000000010000,665.000000010000,666.000000010000,667.000000010000,668.000000010000,669.000000010000,670.000000010000,671.000000010000,672.000000010000,673.000000010000,674.000000010000,675.000000010000,676.000000010000,677.000000010000,678.000000010000,679.000000010000,680.000000010000,681.000000010000,682.000000010000,683.000000010000,684.000000010000,685.000000010000,686.000000010000,687.000000010000,688.000000010000,689.000000010000,690.000000010000,691.000000010000,692.000000010000,693.000000010000,694.000000010000,695.000000010000,696.000000010000,697.000000010000,698.000000010000,699.000000010000,700.000000010000,701.000000010000,702.000000010000,703.000000010000,704.000000010000,705.000000010000,706.000000010000,707.000000010000,708.000000010000,709.000000010000,710.000000010000,711.000000010000,712.000000010000,713.000000010000,714.000000010000,715.000000010000,716.000000010000,717.000000010000,718.000000010000,719.000000010000,720.000000010000,721.000000010000,722.000000010000,723.000000010000,724.000000010000,725.000000010000,726.000000010000,727.000000010000,728.000000010000,729.000000010000,730.000000010000,731.000000010000,732.000000010000,733.000000010000,734.000000010000,735.000000010000,736.000000010000,737.000000010000,738.000000010000,739.000000010000,740.000000010000,741.000000010000,742.000000010000,743.000000010000,744.000000010000,745.000000010000,746.000000010000,747.000000010000,748.000000010000,749.000000010000,750.000000010000,751.000000010000,752.000000010000,753.000000010000,754.000000010000,755.000000010000,756.000000010000,757.000000010000,758.000000010000,759.000000010000,760.000000010000,761.000000010000,762.000000010000,763.000000010000,764.000000010000,765.000000010000,766.000000010000,767.000000010000,768.000000010000,769.000000010000,770.000000010000,771.000000010000,772.000000010000,773.000000010000,774.000000010000,775.000000010000,776.000000010000,777.000000010000,778.000000010000,779.000000010000,780.000000010000,781.000000010000,782.000000010000,783.000000010000,784.000000010000,785.000000010000,786.000000010000,787.000000010000,788.000000010000,789.000000010000,790.000000010000,791.000000010000,792.000000010000,793.000000010000,794.000000010000,795.000000010000,796.000000010000,797.000000010000,798.000000010000,799.000000010000,800.000000010000,801.000000010000]